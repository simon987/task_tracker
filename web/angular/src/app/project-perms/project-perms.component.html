<div class="container">
    <mat-card class="mat-elevation-z8">
        <button mat-button [title]="'perms.refresh' | translate" style="float:right"
                (click)="refresh()">
            <mat-icon>refresh</mat-icon>
        </button>
        <mat-card-header>
            <mat-card-title>{{"perms.title" | translate}}</mat-card-title>
            <mat-card-subtitle>{{"perms.subtitle" | translate}}</mat-card-subtitle>
        </mat-card-header>

        <mat-card-content>
            <mat-list *ngIf="!unauthorized">
                <mat-list-item *ngFor="let wa of accesses" [class.request]="wa.request">
                    <mat-icon mat-list-icon *ngIf="wa.submit" [title]="'perms.assign'|translate">library_add</mat-icon>
                    <mat-icon mat-list-icon *ngIf="wa.assign" [title]="'perms.submit'|translate">get_app</mat-icon>
                    <h4 mat-line>{{wa.worker.alias}} {{wa.request ? ('perms.pending' | translate) : ''}}</h4>
                    <div mat-line>
                        Id=<span class="text-mono">{{wa.worker.id}}</span>, {{"perms.created" | translate}}
                        <span
                            class="text-mono">{{moment.unix(wa.worker.created).utc().format("UTC YYYY-MM-DD HH:mm:ss")}}</span>
                    </div>
                    <span style="flex: 1 1 auto;"></span>
                    <button mat-raised-button color="primary" [title]="'perms.grant' | translate"
                            *ngIf="wa.request" (click)="acceptRequest(wa)">
                        <mat-icon>check</mat-icon>
                    </button>
                    <button mat-raised-button color="warn"
                            [title]="wa.request ? ('perms.reject'|translate) : ('perms.remove'|translate)"
                            (click)="rejectRequest(wa)">
                        <mat-icon>close</mat-icon>
                    </button>
                </mat-list-item>
            </mat-list>
            <p *ngIf="unauthorized" class="unauthorized">
                <mat-icon>block</mat-icon>
                {{"perms.unauthorized" | translate}}
            </p>
        </mat-card-content>

    </mat-card>
</div>
